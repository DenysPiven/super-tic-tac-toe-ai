<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Super Tic-Tac-Toe</title>
    <meta name="description" content="Ultimate Tic-Tac-Toe â€” play 9 boards in one.">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
    <div class="game">
        <aside class="sidebar sidebar-left">
            <div class="controls-top">
                <div class="mode-row">
                    <span class="mode-label">Mode</span>
                    <div class="btn-group">
                        <button type="button" id="modeTwo" class="btn-mode active" data-mode="two">Offline</button>
                        <button type="button" id="modeOnline" class="btn-mode" data-mode="online">Online</button>
                        <button type="button" id="modeAi" class="btn-mode" data-mode="ai">vs AI</button>
                    </div>
                </div>
                <div id="onlinePanel" class="online-panel hidden">
                    <div class="online-row">
                        <button type="button" id="createRoom" class="btn-new">Create room</button>
                        <button type="button" id="joinRoom" class="btn-new">Join room</button>
                    </div>
                    <div id="roomInfo" class="room-info hidden">
                        <div class="room-id-row">
                            <span>Room ID:</span>
                            <code id="roomIdDisplay"></code>
                            <button type="button" id="copyRoomId" class="btn-icon" title="Copy link">ðŸ“‹</button>
                        </div>
                        <div id="roomStatus" class="room-status"></div>
                        <div id="creatorRole" class="creator-role hidden">
                            <span>Creator plays: <strong id="creatorRoleDisplay"></strong></span>
                        </div>
                        <button type="button" id="leaveRoom" class="btn-new">Leave room</button>
                    </div>
                    <div id="joinForm" class="join-form hidden">
                        <input type="text" id="roomIdInput" placeholder="Enter room ID" maxlength="6" style="text-transform: uppercase;">
                        <button type="button" id="joinRoomBtn" class="btn-new">Join</button>
                    </div>
                </div>
                <div id="roleModal" class="modal hidden">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Choose your role</h3>
                        </div>
                        <div class="modal-body">
                            <div id="creatorInfo" class="creator-info"></div>
                            <div class="btn-group" style="justify-content: center; margin-top: 1rem;">
                                <button type="button" id="selectRoleX" class="btn-mode" data-role="X">X</button>
                                <button type="button" id="selectRoleO" class="btn-mode" data-role="O">O</button>
                                <button type="button" id="selectRoleSpectator" class="btn-mode" data-role="spectator">Spectator</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="sideRow" class="side-row hidden">
                    <span class="mode-label">You play</span>
                    <div class="btn-group">
                        <button type="button" id="sideX" class="btn-mode active" data-side="X">X</button>
                        <button type="button" id="sideO" class="btn-mode" data-side="O">O</button>
                    </div>
                </div>
                <button type="button" id="newGame" class="btn-new">New game</button>
            </div>
        </aside>
        <div class="main">
            <header class="header">
                <h1>Super Tic-Tac-Toe</h1>
                <p id="status" class="status" aria-live="polite">X's turn</p>
            </header>
            <main class="board-wrap">
                <div id="area" class="area" role="grid" aria-label="Ultimate tic-tac-toe board"></div>
            </main>
        </div>
        <aside class="sidebar sidebar-right">
            <div class="controls-top">
                <div class="settings-group">
                    <label class="setting-label">Show Move Probabilities</label>
                    <div class="btn-group">
                        <button type="button" id="heatmapToggle" class="btn-mode active" data-heatmap="on">On</button>
                        <button type="button" class="btn-mode" data-heatmap="off">Off</button>
                    </div>
                </div>
            </div>
        </aside>
    </div>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js" onerror="console.error('Failed to load PeerJS')"></script>
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>
    <script>
        // Wait for PeerJS to load before initializing
        if (typeof Peer === 'undefined') {
            window.addEventListener('load', function() {
                if (typeof Peer === 'undefined') {
                    console.error('PeerJS failed to load');
                }
            });
        }
    </script>
    <script src="script.js"></script>
</body>
</html>
